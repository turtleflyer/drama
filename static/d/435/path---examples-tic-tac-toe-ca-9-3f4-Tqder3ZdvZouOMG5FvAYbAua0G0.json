{"data":{"markdownRemark":{"html":"<div id=\"tic-tac-toe\"> </div>\n<h1>Examples of drama library use</h1>\n<h3>Example of Tic-tac-toe game</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Define the class of cells that the board of tic-tac-toe</span>\n<span class=\"token comment\">// game consists of</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Cell</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node <span class=\"token operator\">=</span> <span class=\"token function\">createCell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// interpretTarget property of the parameter passed to</span>\n<span class=\"token comment\">// defineRoutine defines the way to reach the DOM element of</span>\n<span class=\"token comment\">// event targets</span>\n<span class=\"token function\">defineRoutine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token function-variable function\">interpretTarget</span><span class=\"token punctuation\">:</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> e<span class=\"token punctuation\">.</span>node <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Define the messages strings</span>\n<span class=\"token keyword\">const</span> cellMarkedMessage <span class=\"token operator\">=</span> <span class=\"token string\">'The cell is already set'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gameOverMessage <span class=\"token operator\">=</span> <span class=\"token string\">'Game is over'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> winMessages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'X won'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'O won'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Define the names of methods that mark cells as X and O</span>\n<span class=\"token keyword\">const</span> turns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'markX'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'markO'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Add methods to the Cell class that mark a cell as X and</span>\n<span class=\"token comment\">// O, method that marks a cell as a part of a wining line,</span>\n<span class=\"token comment\">// and one that resets a cell to the empty state</span>\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Cell</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span>turns<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> markX<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span>turns<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> markO<span class=\"token punctuation\">,</span>\n  markAsWin<span class=\"token punctuation\">,</span>\n  resetCell<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Build the board of the game</span>\n<span class=\"token keyword\">const</span> gameMatrix <span class=\"token operator\">=</span> <span class=\"token function\">buildMatrix</span><span class=\"token punctuation\">(</span>Cell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Define the RoleSet containing empty cells (in the</span>\n<span class=\"token comment\">// beginning of the game all cells are empty)</span>\n<span class=\"token keyword\">const</span> emptyCells <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RoleSet</span><span class=\"token punctuation\">(</span>gameMatrix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Define a function keeping the record of marked cells (for</span>\n<span class=\"token comment\">// each type of marks)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">keepState</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cell<span class=\"token punctuation\">,</span> filledCells</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> cellN <span class=\"token operator\">=</span> gameMatrix<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>filledCells<span class=\"token punctuation\">,</span> cellN<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a <span class=\"token operator\">-</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Define two empty RoleSet's for X and O</span>\n<span class=\"token keyword\">const</span> xAndOs <span class=\"token operator\">=</span> turns<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">turn<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token keyword\">set</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RoleSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Define action for the event when a new element is being</span>\n  <span class=\"token comment\">// added to RoleSet</span>\n  <span class=\"token function\">setActionOnAddElement</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">set</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Keep the record of marked cells in closure</span>\n      <span class=\"token keyword\">let</span> filledCells <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> target<span class=\"token punctuation\">,</span> roleSet <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Reset the record when the first element is added</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>roleSet<span class=\"token punctuation\">.</span>size <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          filledCells <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">// Mark the cell</span>\n        target<span class=\"token punctuation\">[</span>turn<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Add the cell to the record</span>\n        filledCells <span class=\"token operator\">=</span> <span class=\"token function\">keepState</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> filledCells<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Check if the state of win exists</span>\n        <span class=\"token keyword\">const</span> possibleWin <span class=\"token operator\">=</span> <span class=\"token function\">analyzePossibleWin</span><span class=\"token punctuation\">(</span>filledCells<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// If analyzePossibleWin returns an array of cells</span>\n        <span class=\"token comment\">// set them the win state</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>possibleWin<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          emptyCells<span class=\"token punctuation\">.</span><span class=\"token function\">clearElements</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          xAndOs<span class=\"token punctuation\">.</span><span class=\"token function\">clearElements</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          possibleWin<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            gameMatrix<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">markAsWin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token comment\">// Post the message saying who wins</span>\n          <span class=\"token function\">postTextMessage</span><span class=\"token punctuation\">(</span>winMessages<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n          <span class=\"token comment\">// otherwise check if all cells are marked</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>emptyCells<span class=\"token punctuation\">.</span>size <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// Clear elements from the both sets and post the</span>\n          <span class=\"token comment\">// message that the game is over</span>\n          xAndOs<span class=\"token punctuation\">.</span><span class=\"token function\">clearElements</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">postTextMessage</span><span class=\"token punctuation\">(</span>gameOverMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Define the action for the event of 'click' type</span>\n  <span class=\"token function\">eventChain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    roleSet<span class=\"token punctuation\">:</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">,</span>\n    type<span class=\"token punctuation\">:</span> <span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">action</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Post the message that the cell is occupied</span>\n      <span class=\"token function\">postTextMessage</span><span class=\"token punctuation\">(</span>cellMarkedMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Add the method that clear both (X and O) RoleSets</span>\nxAndOs<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">clearElements</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">set</span></span> <span class=\"token operator\">=></span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">.</span><span class=\"token function\">clearElements</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Define the function that sets the state of a cell and</span>\n<span class=\"token comment\">// returns the next turn (for X or O)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">setCell</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">currentTurn<span class=\"token punctuation\">,</span> cell</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  xAndOs<span class=\"token punctuation\">[</span>currentTurn<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">addElement</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> currentTurn<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Define the action for the event of 'click' type</span>\n<span class=\"token function\">eventChain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  roleSet<span class=\"token punctuation\">:</span> emptyCells<span class=\"token punctuation\">,</span>\n  type<span class=\"token punctuation\">:</span> <span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span>\n  action<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">firstTurn</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Store the current turn in closure</span>\n    <span class=\"token keyword\">let</span> currentTurn <span class=\"token operator\">=</span> firstTurn<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> target<span class=\"token punctuation\">,</span> roleSet <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Check if the game has just begun and reset the</span>\n      <span class=\"token comment\">// first turn</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>roleSet<span class=\"token punctuation\">.</span>size <span class=\"token operator\">===</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        currentTurn <span class=\"token operator\">=</span> firstTurn<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      currentTurn <span class=\"token operator\">=</span> <span class=\"token function\">setCell</span><span class=\"token punctuation\">(</span>currentTurn<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Define the action that restarts the game</span>\nrestartButton<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Reset all cells</span>\n  gameMatrix<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cell</span> <span class=\"token operator\">=></span> cell<span class=\"token punctuation\">.</span><span class=\"token function\">resetCell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// and add them to the initial RoleSet</span>\n  emptyCells<span class=\"token punctuation\">.</span><span class=\"token function\">addElements</span><span class=\"token punctuation\">(</span>gameMatrix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"inject":["tic-tac-toe"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/examples/tic-tac-toe/"}}